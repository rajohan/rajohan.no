<?php

    //-------------------------------------------------
    // Direct access check
    //-------------------------------------------------

    if(!defined('INCLUDE')) {

        die('Direct access is not permitted.');
        
    }

    //-------------------------------------------------
    // Validator
    //-------------------------------------------------

    class Validator {

        //-------------------------------------------------
        // Username validator
        //-------------------------------------------------

        function validate_username($data) {

            $pattern = '/^[\w\-]{5,15}$/';
            return preg_match($pattern, $data);

        }

        //-------------------------------------------------
        // Password validator
        //-------------------------------------------------

        function validate_password($data) {

            $pattern = '/^.{6,}$/';
            return preg_match($pattern, $data);

        }


        //-------------------------------------------------
        // Email validator
        //-------------------------------------------------

        function validate_mail($data) {

            $pattern = '/^(?!(?:(?:\x22?\x5C[\x00-\x7E]\x22?)|(?:\x22?[^\x5C\x22]\x22?)){255,})(?!(?:(?:\x22?\x5C[\x00-\x7E]\x22?)|(?:\x22?[^\x5C\x22]\x22?)){65,}@)(?:(?:[\x21\x23-\x27\x2A\x2B\x2D\x2F-\x39\x3D\x3F\x5E-\x7E]+)|(?:\x22(?:[\x01-\x08\x0B\x0C\x0E-\x1F\x21\x23-\x5B\x5D-\x7F]|(?:\x5C[\x00-\x7F]))*\x22))(?:\.(?:(?:[\x21\x23-\x27\x2A\x2B\x2D\x2F-\x39\x3D\x3F\x5E-\x7E]+)|(?:\x22(?:[\x01-\x08\x0B\x0C\x0E-\x1F\x21\x23-\x5B\x5D-\x7F]|(?:\x5C[\x00-\x7F]))*\x22)))*@(?:(?:(?!.*[^.]{64,})(?:(?:(?:xn--)?[a-z0-9]+(?:-[a-z0-9]+)*\.){1,126}){1,}(?:(?:[a-z][a-z0-9]*)|(?:(?:xn--)[a-z0-9]+))(?:-[a-z0-9]+)*)|(?:\[(?:(?:IPv6:(?:(?:[a-f0-9]{1,4}(?::[a-f0-9]{1,4}){7})|(?:(?!(?:.*[a-f0-9][:\]]){7,})(?:[a-f0-9]{1,4}(?::[a-f0-9]{1,4}){0,5})?::(?:[a-f0-9]{1,4}(?::[a-f0-9]{1,4}){0,5})?)))|(?:(?:IPv6:(?:(?:[a-f0-9]{1,4}(?::[a-f0-9]{1,4}){5}:)|(?:(?!(?:.*[a-f0-9]:){5,})(?:[a-f0-9]{1,4}(?::[a-f0-9]{1,4}){0,3})?::(?:[a-f0-9]{1,4}(?::[a-f0-9]{1,4}){0,3}:)?)))?(?:(?:25[0-5])|(?:2[0-4][0-9])|(?:1[0-9]{2})|(?:[1-9]?[0-9]))(?:\.(?:(?:25[0-5])|(?:2[0-4][0-9])|(?:1[0-9]{2})|(?:[1-9]?[0-9]))){3}))\]))$/iD';
            return preg_match($pattern, $data);

        }

        //-------------------------------------------------
        // Name validator
        //-------------------------------------------------

        function validate_name($data) {

            $pattern = '/^\p{L}[\p{L} \'&-]*[\p{L}]$/u';
            return preg_match($pattern, $data);

        }

        //-------------------------------------------------
        // Url validator
        //-------------------------------------------------

        function validate_url($data) {

            $pattern = '/^(http:\/\/www\.|https:\/\/www\.|http:\/\/|https:\/\/)?[a-z0-9]+([\-\.]{1}[a-z0-9]+)*\.[a-z]{2,5}(:[0-9]{1,5})?(\/.*)?$/m';
            return preg_match($pattern, $data);

        }

        //-------------------------------------------------
        // Telephone validator
        //-------------------------------------------------

        function validate_tel($data) {

            $pattern = '/^(?:[0-9-+()\s]){0,6}(?:[0-9-+()\s]){0,6}([0-9\s]){4,15}$/';
            return preg_match($pattern, $data);

        }

        //-------------------------------------------------
        // Firmname validator
        //-------------------------------------------------
        
        function validate_firmname($data) {

            $pattern = '/^(?!\s)(?!.*\s$)(?=.*[a-zA-Z0-9])[a-zA-Z0-9 \' ~ ? ! ~ ` ? ! ^ * ¨ ; @ = $ % { } [ \] \| \/ . < > # “ " \- ‘]{2,}$/';
            return preg_match($pattern, $data);

        }

        //-------------------------------------------------
        // Token code validator
        //-------------------------------------------------

        function validate_token_code($data) {

            $pattern = '/^[a-z A-Z 0-9]{6,6}$/';
            return preg_match($pattern, $data);

        }

    }

  ?>